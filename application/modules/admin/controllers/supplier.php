<?phpclass supplier extends MY_Controller{    public function __construct(){        parent::__construct();        $this->_data['now'] = 'Chất Liệu';        $this->load->model('msupplier');        $this->load->model('mproduct');        $user = $this->session->userdata('user');        if(!$user || $user['user_type'] != 'administrator'){            if($user['user_type']=='nhanvien'){                redirect(base_url()."admin/product/phieubanhang");             }            else                redirect(base_url()."admin/login");        }        $this->form_validation->CI =& $this;        //--------        //Lấy đường dẫn url của thư mục chứa hình ảnh được upload        $this->_gallery_url = base_url()."public/supplier/";        //Lấy đường dẫn vật lý của thư mục chứa hình ảnh đươc upload        $this->_gallery_path = realpath(APPPATH. "../public/supplier");    }    public function listall(){        if(!isset($_GET['per_page'])){            $start = 0 ;        }else{            $start=$_GET['per_page'];        }        if(!isset($_GET['s'])){            $s = '' ;        }else{            $s=$_GET['s'];        }        $this->_data['s'] = $s;        $this->load->library('pagination');        $config['base_url'] = base_url().'admin/supplier/listall?s='.$s;        //config phân trang        $config['total_rows'] = $this->msupplier->numRows($s);        $config['per_page'] =15;        $config['uri_segment'] = 4;        $config['cur_tag_open'] = "<li><a><font color='black'>";        $config['cur_tag_close'] = '</font></a></li>';        $config['num_tag_open'] = '<li>';        $config['num_tag_close'] = '</li>';        $config['prev_link'] = 'Prev';        $config['prev_tag_open'] = '<li>';        $config['prev_tag_close'] = '</li>';        $config['next_link'] = 'Next';        $config['next_tag_open'] = '<li>';        $config['next_tag_close'] = '</li>';        $config['first_tag_open'] = '<li>';        $config['first_tag_close'] = '</li>';        $config['last_tag_open'] = '<li>';        $config['last_tag_close'] = '</li>';        $this->pagination->initialize($config);        $this->_data['pagination']=$this->pagination->create_links();        $this->_data['template'] = 'admin/supplier/list_view';        $this->_data['title'] = 'Trang Quản Lý Danh Mục ';        $this->_data['info'] = $this->msupplier->listAll($config['per_page'],$start,$s);        $this->load->view("layout/admin",$this->_data);    }    public function listProduct($sup){        if(!isset($_GET['per_page'])){            $start = 0 ;        }else{            $start=$_GET['per_page'];        }        $this->_data['s'] = '';        $this->load->library('pagination');        $config['base_url'] = base_url().'admin/supplier/listproduct/'.$sup.'?';        //config phân trang        $config['total_rows'] = $this->msupplier->numRowsProduct($sup);        $config['per_page'] =15;        $config['uri_segment'] = 4;        $config['cur_tag_open'] = "<li><a><font color='black'>";        $config['cur_tag_close'] = '</font></a></li>';        $config['num_tag_open'] = '<li>';        $config['num_tag_close'] = '</li>';        $config['prev_link'] = 'Prev';        $config['prev_tag_open'] = '<li>';        $config['prev_tag_close'] = '</li>';        $config['next_link'] = 'Next';        $config['next_tag_open'] = '<li>';        $config['next_tag_close'] = '</li>';        $config['first_tag_open'] = '<li>';        $config['first_tag_close'] = '</li>';        $config['last_tag_open'] = '<li>';        $config['last_tag_close'] = '</li>';        $this->pagination->initialize($config);        $this->_data['pagination']=$this->pagination->create_links();        $this->_data['template'] = 'admin/supplier/list_product';        $this->_data['title'] = 'Trang ';        $this->_data['info'] = $this->msupplier->listAllProduct($config['per_page'],$start,$sup);        $this->load->view("layout/admin",$this->_data);    }    public function add(){        $this->_data['action'] = strtolower(__FUNCTION__);        if(isset($_POST['ok'])){            $this->form_validation->set_rules("name","Tên Khách Hàng","required");            if($this->form_validation->run()==TRUE){                                $arr = array(                    'name' => $this->input->post('name'),                    'link' => $this->input->post('link'),                    'created' =>time(),                    'updated' =>time(),                );                $this->msupplier->add($arr);                $this->session->set_flashdata('ses_flash',"Thêm");                redirect(base_url()."admin/supplier/listall");            }        }        $this->_data['template'] = 'admin/supplier/modify_view';        $this->_data['title'] = 'Trang Thêm Thực Đơn ';        $this->load->view("layout/admin",$this->_data);    }    public function del($id){        $product = $this->mproduct->getSupplier2($id);        foreach($product as $p){            $arr = array(                'supplier_id'=>83            );            $this->mproduct->editById($p['id'],$arr);        }        $this->msupplier->del($id);        $this->session->set_flashdata('ses_flash',"Xóa");        redirect(base_url()."admin/supplier/listall");    }    public function dellist(){        foreach($_POST['del']as $id){            $this->msupplier->del($id);        }        $this->session->set_flashdata('ses_flash',"Xóa");        redirect(base_url()."admin/supplier/listall");    }    public function edit($id){        $this->load->library("upload");        $this->_data['action'] = strtolower(__FUNCTION__);        if(isset($_POST['ok'])){            $this->form_validation->set_rules("name","Tên Khách Hàng","required");            if($this->form_validation->run()==TRUE){                $arr = array(                    'name' => $this->input->post('name'),                    'link' => $this->input->post('link'),                    'updated' =>time(),                );                $this->msupplier->editById($id,$arr);                $this->session->set_flashdata('ses_flash',"Sửa");                redirect(base_url()."admin/supplier/listall");            }        }        $this->_data['info'] = $this->msupplier->getById($id);        $this->_data['template'] = 'admin/supplier/modify_view';        $this->_data['title'] = 'Trang Sửa User ';        $this->load->view("layout/admin",$this->_data);    }    function image_check(){        if ($_FILES['avatar']['name']!='') return true;        $this->form_validation->set_message('image_check', 'Vui lòng tải Ảnh Banner');        return FALSE;    }    function image_mini_check(){        if ($_FILES['mini_avatar']['name']!='') return true;        $this->form_validation->set_message('image_mini_check', 'Vui lòng tải Ảnh Đại Diện');        return FALSE;    }}